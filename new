best <- function(state,outcome){    data <- read.csv("./data/outcome-of-care-measures.csv")    stlist <- data.frame(table(data$State))[,1]  if(outcome =="heart attack"){OC1 <- "Heart.Attack"}  else if(outcome =="heart failure"){OC1 <- "Heart.Failure"}  else if(outcome =="pneumonia"){OC1 <- "Pneumonia"}  else OC1 <- outcome  oclist <- c("Heart.Failure", "Heart.Attack", "Pneumonia")  if(OC1 %in% oclist){        if(state %in% stlist){      varname <- paste("Hospital.30.Day.Death..Mortality..Rates.from.",OC1, sep = "")  statedata = subset(data, State == state)  keeplist=c("Hospital.Name", "State", varname)   subdata <- statedata[keeplist]  subdata[complete.cases(subdata),]  newdata <- subdata[order(suppressWarnings(as.numeric( subdata[,3])), subdata[,1] ),  ] print(newdata[1,1])     }    else stop("invalid State")  } else stop("invalid outcome")
}
rankhospital <- function(state,outcome, num=1){    data <- read.csv("./data/outcome-of-care-measures.csv")    stlist <- data.frame(table(data$State))[,1]  if(outcome =="heart attack"){OC1 <- "Heart.Attack"}  else if(outcome =="heart failure"){OC1 <- "Heart.Failure"}  else if(outcome =="pneumonia"){OC1 <- "Pneumonia"}  else OC1 <- outcome  oclist <- c("Heart.Failure", "Heart.Attack", "Pneumonia")  if(OC1 %in% oclist){        if(state %in% stlist){            varname <- paste("Hospital.30.Day.Death..Mortality..Rates.from.",OC1, sep = "")      statedata = subset(data, State == state)      keeplist=c("Hospital.Name", "State", varname)            subdata <- statedata[keeplist]       subdata[complete.cases(subdata),]      newdata <- subdata[order(suppressWarnings(as.numeric( subdata[,3])), subdata[,1] ),  ]      newdata$rank <- seq.int(nrow(newdata))       if(num =="best"){num1 <- 1}      else if(num == "worst"){num1 <- max(newdata$rank)}      else num1 <- num      rankdata <- subset(newdata, rank == num1)      if(num1 > max(newdata$rank)){print(NA)}      else {print(rankdata[1,1])}        }    else stop("invalid State")  }  else stop("invalid outcome")  }
rankall <- function(outcome, num=1){    data <- read.csv("./data/outcome-of-care-measures.csv")    #  stlist <- data.frame(table(data$State))[,1]  if(outcome =="heart attack"){OC1 <- "Heart.Attack"}  else if(outcome =="heart failure"){OC1 <- "Heart.Failure"}  else if(outcome =="pneumonia"){OC1 <- "Pneumonia"}  else OC1 <- outcome  oclist <- c("Heart.Failure", "Heart.Attack", "Pneumonia")  if(OC1 %in% oclist){                varname <- paste("Hospital.30.Day.Death..Mortality..Rates.from.",OC1, sep = "")        keeplist=c("Hospital.Name", "State", varname)        subdata <- data[keeplist]     #subdata[complete.cases(subdata),]    newdata <- subdata[order(subdata[,2],suppressWarnings(as.numeric( subdata[,3])), subdata[,1] ),  ]    newdata$rank <- ave(newdata[,3],newdata$State,FUN=seq.int)    newdata[,4] <- sapply(newdata[,4],as.numeric)    newdata$lowrank <- ave(newdata$rank,newdata$State,FUN=max)    if(num =="best"){num1 <- 1}    else if(num == "worst"){      newdata[,3] <- sapply(newdata[,3],as.numeric)      newdata_cln <- subset(newdata, !is.na(newdata[,3]))      newdata_cln$lrank <- ave(newdata_cln[,4],newdata_cln$State,FUN=max)      rankdata <- subset(newdata_cln, newdata_cln$rank == newdata_cln$lrank)    }    else     {num1 <- num        if(num1 > newdata$lowrank){      newdata$rank[newdata$rank == newdata$lowrank] <- num1    }    else{newdata <- newdata }    rankdata <- subset(newdata, rank == num1)    if(num1 > max(newdata$rank)){print(NA)}    else {rankdata}}        colnames(rankdata)[3] <-"disease"    colnames(rankdata)[1] <-"Hospital"    rankdata$ctr <- suppressWarnings(ave(rankdata[,5], rankdata$State, FUN=seq.int))    rankdata$Hospital[rankdata$disease == "Not Available"] <- NA    pdata <- subset(rankdata , ctr == 1)    findata <- pdata[,c(1,2)]  }  else stop("invalid outcome")  }
